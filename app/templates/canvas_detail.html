{% extends 'base.html' %}

{% block content %}
<h1>{{ canvas.title }}</h1>
<p>{{ canvas.description }}</p>
<img src="{{ canvas.image_url }}" alt="{{ canvas.title }}">
<a href="{{ url_for('vote_canvas', canvas_id=canvas.id, vote=1) }}">Upvote</a>
<a href="{{ url_for('vote_canvas', canvas_id=canvas.id, vote=-1) }}">Downvote</a>

<h2>Comments</h2>
{% for comment in canvas.comments %}
    <p>{{ comment.user.username }} says: {{ comment.content }}</p>
    <a href="{{ url_for('vote_comment', comment_id=comment.id, vote=1) }}">Upvote</a>
    <a href="{{ url_for('vote_comment', comment_id=comment.id, vote=-1) }}">Downvote</a>
{% endfor %}

<!-- Add form for new comment here if the user is logged in -->
{% if current_user.is_authenticated %}
    <form method="post" action="{{ url_for('add_comment', canvas_id=canvas.id) }}">
        <textarea name="comment" required></textarea>
        <input type="submit" value="Add Comment">
    </form>

{% else %}
    <p><a href="{{ url_for('login') }}">Log in</a> to add a comment.</p>
{% endif %}

<form action="{{ url_for('vote_canvas', canvas_id=canvas.id, vote=1) }}" method="post">
    <button type="submit">Upvote Canvas</button>
</form>
<form action="{{ url_for('vote_canvas', canvas_id=canvas.id, vote=-1) }}" method="post">
    <button type="submit">Downvote Canvas</button>
</form>
{% endblock %}
